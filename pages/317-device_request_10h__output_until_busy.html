<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Device Request 10H: Output Until Busy - TECH Help!</title><link rel="stylesheet" type="text/css" href="style.css"><meta http-equiv="X-UA-Compatible" content="IE=Edge"></head><body><h1>Device Request 10H: Output Until Busy</h1><pre>                                                                <a href="327-_chr_.html">◄Chr►</a> <a href="333-_otb_.html">◄OTB►</a>
 This tells the driver to write data to the device until the device signals
 that it cannot accept any more data.

<span class="c2">DevReq10Rec</span>
  Offset Size Contents
  ▀▀▀▀▀▀ ▀▀▀▀ ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   +0      1  <span class="c1">bLen</span>         14H (length of this request packet)
   +1      1  <span class="c1">bUnitNo</span>      (not used)
   +2      1  <span class="c1">bCmd</span>         <span class="c2">10H</span> (command code)
   +3      2  <span class="c1">rStatus</span>      OUTPUT: <a href="325-device_status_word.html">Device Status Word</a> must fill before exit
   +5H     8  <span class="c1">res</span>          (reserved)
  +0dH     1  <span class="c1">bData</span>        (not used)
  +0eH     4  <span class="c1">pfBuffer</span>     INPUT: buffer address
  +12H     2  <span class="c1">wWriteSize</span>   INPUT: number of bytes to write
                           OUTPUT: bytes actually written
          20               size of this structure

     <span class="c1">rStatus</span>  On exit, the driver must place a <a href="325-device_status_word.html">DevStatusWord</a> here.  Always
              set the Done bit (<span class="c1">bit 8</span>).  On an error, set the Done bit and
              the Error bit (<span class="c1">bit 15</span>) and put a <a href="326-device_driver_errors.html">Device Error Code</a> in the low
              byte.

              It is NOT an error to write fewer than the requested number of
              bytes.  Just set the Done bit, update <span class="c1">wWriteSize</span>, and exit.

    <span class="c1">pfBuffer</span>  is the address of a buffer containing data to write to the
              device.

  <span class="c1">wWriteSize</span>  on entry, specifies how much data to transfer from <span class="c1">pfBuffer</span> to
              the device.

              On return, fill this with the actual amount of data you
              transferred, in bytes.

   Notes: ■ Only character device drivers capable of Output-Until-Busy need
            support this request (see <a href="323-device_attribute.html">Device Attribute</a> <span class="c1">bit 13</span>).

          ■ The driver must transfer as much data as possible, update the
            <span class="c1">wWriteSize</span> field, set <span class="c1">bit 8</span>, and return <span class="c2">immediately</span>.

          ■ This fn makes it possible for DOS to optimize its device output
            activities and to take advantage of hardware features such as a
            printer's internal input buffer.

            For instance, DOS can pass a large buffer of data, and the
            driver can fill the printer's buffer and return.  Then DOS can
            periodically check the output status (<a href="311-device_request_0ah__output_status.html">DvRq 0aH</a>) and call this
            fn again (passing only the unprocessed data) when the device is
            not busy.  This avoids tying up the system inside a driver's
            wait loop.

See Also: <a href="300-device_requests.html">Device Requests</a>
          <a href="324-device_request_header.html">DevRequestHdrRec</a>
          <a href="298-installable_device_drivers.html">Installable Device Drivers</a>
                                    <span class="c3">-♦-</span></pre></body></html>
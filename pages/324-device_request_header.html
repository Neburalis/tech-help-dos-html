<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Device Request Header - TECH Help!</title><link rel="stylesheet" type="text/css" href="style.css"><meta http-equiv="X-UA-Compatible" content="IE=Edge"></head><body><h1>Device Request Header</h1><pre>
 Each request to a <a href="298-installable_device_drivers.html">device driver</a> is accompanied by a pointer to a request
 structure or &quot;packet&quot;.  Each packet begins with this 13-byte header.  Upon
 entry into a driver, <span class="c2">ES:BX</span> always points to a packet in this layout.

<span class="c2">DevRequestHdrRec</span>
  Offset Size Contents
  ▀▀▀▀▀▀ ▀▀▀▀ ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
   +0      1  <span class="c1">bLen</span>         length of this request packet (header and data)
   +1      1  <span class="c1">bUnitNo</span>      unit number (used for block devices only)
   +2      1  <span class="c1">bCmd</span>         command code (<a href="300-device_requests.html">Device Request</a> number)
   +3      2  <span class="c1">rStatus</span>      <a href="325-device_status_word.html">Device Status Word</a> must be filled before return
   +5H     8  <span class="c1">res</span>          (reserved)
          13               length of common portion of all request packets
  +0dH     ?  <span class="c1">abData</span>       variable-length data formatted according to the
                           command code.  See <a href="300-device_requests.html">Device Requests</a>.

     <span class="c1">rStatus</span>  On exit, the driver must place a <a href="325-device_status_word.html">DevStatusWord</a> here.  Always
              set the Done bit (<span class="c1">bit 8</span>) -- even if you don't support the
              request or when there's an error.

              If you can't process the request because of hardware failure
              or other error, set the Error bit (<span class="c1">bit 15</span>) and put
              <a href="326-device_driver_errors.html">Device Error Code</a> in the low byte.

      <span class="c1">abData</span>  data beginning here varies depending upon the request.

See Also: <a href="298-installable_device_drivers.html">Device Drivers</a>
          <a href="300-device_requests.html">Device Requests</a>
                                    <span class="c3">-♦-</span></pre></body></html>